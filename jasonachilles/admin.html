<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Jason Achilles Admin</title>
<style>
body { background:#000; color:#0ff; font-family: 'Orbitron',sans-serif; padding:40px; }
h1 { text-align:center; font-size:2.5rem; margin-bottom:40px; }
form { max-width:500px; margin:0 auto; display:flex; flex-direction:column; gap:18px; }
input, button { padding:10px; border-radius:6px; border:none; font-family:'Orbitron',sans-serif; font-size:1rem; }
button { background:#0ff; color:#000; font-weight:bold; cursor:pointer; }
button:hover { background:#0cc; }
ul { margin-top:20px; }
li { margin-bottom:12px; }
</style>
</head>
<body>

<h1>Admin - Edit Shows</h1>

<form id="adminForm">
  <input type="password" id="adminPassword" placeholder="Enter password" required>
  <input type="text" id="showName" placeholder="Show Name" required>
  <input type="date" id="showDate" required>
  <input type="url" id="showLink" placeholder="Link to venue/info" required>
  <button type="submit">Add Show</button>
</form>

<ul id="currentShows"></ul>

<script>
const PASSWORD = "danascullyiloveu"; // hello there. you shouldn't be here. don't be a fuckass and mess with my listings.
const form = document.getElementById('adminForm');
const list = document.getElementById('currentShows');

async function loadCurrentShows() {
  try {
    const res = await fetch('shows.json');
    const shows = await res.json();
    list.innerHTML = '';
    shows.forEach(s => {
      const li = document.createElement('li');
      li.innerHTML = `${s.name} - ${s.date} <a href="${s.link}" target="_blank">More info</a>`;
      list.appendChild(li);
    });
  } catch(e) { console.error(e); list.innerHTML = '<li>No shows yet.</li>'; }
}

form.addEventListener('submit', async e => {
  e.preventDefault();
  const pw = document.getElementById('adminPassword').value;
  if(pw !== PASSWORD){ alert('Wrong password'); return; }
  const name = document.getElementById('showName').value;
  const date = document.getElementById('showDate').value;
  const link = document.getElementById('showLink').value;
  
  try {
    await fetch('/.netlify/functions/save-shows', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({name,date,link})
    });
    document.getElementById('showName').value='';
    document.getElementById('showDate').value='';
    document.getElementById('showLink').value='';
    loadCurrentShows();
    alert('Show added!');
  } catch(err){ alert('Error saving show'); console.error(err); }
});

loadCurrentShows();
</script>
</body>
</html>
